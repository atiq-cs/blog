

<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Notes from Qubit Inc. - C&#x2B;&#x2B; ifstream::get method overloads</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<!--[if lte IE 8]><script src="/assets/js/ie/html5shiv.js"></script><![endif]-->
		<link rel="stylesheet" href="/assets/sass/main.css" />
		<!--[if lte IE 9]><link rel="stylesheet" href="/assets/sass/ie9.css" /><![endif]-->
		<!--[if lte IE 8]><link rel="stylesheet" href="/assets/sass/ie8.css" /><![endif]-->
        

	</head>
	<body>

		<!-- Page Wrapper -->
			<div id="page-wrapper">
				
				<!-- Header -->
				<header id="header">
					<h1><a href="/">Notes from Qubit Inc.</a></h1>
					<nav>
						<a href="#menu">Menu</a>
					</nav>
				</header>

				<!-- Menu -->
				<nav id="menu">
					<div class="inner">
						<h2>Menu</h2>
						<ul class="links">
							        <li><a href="/posts">Archive</a></li>
        <li><a href="/tags">Tags</a></li>
        <li><a href="/about">About Me</a></li>

						</ul>
						<a href="#" class="close">Close</a>
					</div>
				</nav>


    
<section id="banner">
  <div class="inner">
    <h2>C&#x2B;&#x2B; ifstream::get method overloads</h2>
            <p><em>Published on Tuesday, November 27, 2012</em></p>
                    <a role="button" href="/tags/C&#x2B;&#x2B;" class="button small">C&#x2B;&#x2B;</a>
  </div>
</section>

				<!-- Main -->
				<section id="wrapper">
					<section class="wrapper style2">
						<div class="inner">
							

<p>As stated on the reference, <code>istream::get()</code> has 6 overloads,</p>
<pre><code>int get();
istream&amp; get ( char&amp; c );
istream&amp; get ( char* s, streamsize n );
istream&amp; get ( char* s, streamsize n, char delim );
istream&amp; get ( streambuf&amp; sb);
istream&amp; get ( streambuf&amp; sb, char delim );
</code></pre>
<p>It is also stated that <code>int get();</code> Extracts a character from the stream and returns its value (casted to an integer).</p>
<p>On the other hand.</p>
<pre><code>istream&amp; get ( char&amp; c );
</code></pre>
<p>extracts a character from the stream and stores it in c.</p>
<pre><code>istream&amp; get (char* s, streamsize n );
</code></pre>
<p><a href="http://www.cplusplus.com/reference/istream/istream/get/">cplusplus.com - istream::get</a> has further details.</p>
<h2 id="sampe-program-and-output">Sampe Program and Output</h2>
<p>We shall write a simple program that counts words on each line of a text file. If we cut to the chess, strategy is to take every character, if the character is a separator set a flag, depending on that when a char is found other than separator increment word count and unset the flag until next separator is found. When newline character is found print number of words found on that line. Here's the program,</p>
<pre><code class="language-cpp">#include &lt;ifstream&gt;
#include &lt;iostream&gt;
using namespace std;
    
int main () {
        string separators(&quot;:;.!\&quot;\' \t\n&quot;);
        ifstream ifs ( &quot;test.txt&quot; , ifstream::in );
        bool shouldCountNewWord = true;
        int wordCount=0;
    
        while (ifs.good()) {
            char ch = ifs.get();
            int i = 0;
            for (; i&lt;separators.length(); i++) {
                if (ch == separators[i]) {
                    shouldCountNewWord = true;
                    break;
                }
            }
    
            if (i== (int) separators.length() &amp;&amp; shouldCountNewWord == true) {
                wordCount++;
                shouldCountNewWord = false;
            }
    
    
            if (ch == '\n') {
                cout&lt;&lt;&quot;We have encountered &quot;&lt;&lt;wordCount&lt;&lt;&quot; words in this line.&quot;&lt;&lt;endl;
                wordCount = 0;
            }
        }
        ifs.close();
        return 0;
}
</code></pre>
<p>So the input text file test.txt. Let's create it inside the same directory with some random contents,</p>
<pre><code>Mazel tov! Jewish tradition.
He is not stingy; she is not like him.
&quot;Experilus!&quot; He cried.
I have 2 houses. How many do you have?
</code></pre>
<p>After compiling and executing the binary output of this program appears,</p>
<pre><code>We have encountered 4 words in this line.
We have encountered 9 words in this line.
We have encountered 3 words in this line.
We have encountered 9 words in this line.
</code></pre>
<p>If you are using Linux stay aware that on Linux, editors like vi, gedit adds an extra newline before end of line as convention. Hence, Hence on that platform, if you add a newline yourself after last line you will see that output prints an extra line saying it has encountered 0 lines on that line. Therefore don't add any newline after last line.</p>
<h3 id="the-variation">The Variation</h3>
<p>We have tested <code>int istream::get()</code>. Let's go ahead and replace it with <code>istream&amp; istream::get ( char&amp; c )</code>. Let's just replace the line <code>char ch = ifs.get();</code> with lines as shown below,</p>
<pre><code>while (ifs.good()) {
     char ch;
     ifs.get(ch);
     .............. // code continues
}
</code></pre>
<p>After we compile and run the program new output is,</p>
<pre><code>We have encountered 4 words in this line.
We have encountered 9 words in this line.
We have encountered 3 words in this line.
We have encountered 9 words in this line.
We have encountered 0 words in this line.
</code></pre>
<h3 id="reason-for-such-unexpected-output">Reason for such unexpected output</h3>
<p>Apparently second version of the code is getting an extra newline character. But the file hasn't changed. Where did it come from? If we add an extra statement and print all characters taken as input we see that there variable ch contains newline twice! On the last one ch contains newline value which 10 though eof has already been reached.</p>
<p>Why this behavior? Answer is that, when function get (signature: istream&amp; istream::get ( char&amp; c )) encounters EOF it does not assign it to the character variable because it is not really valid character.</p>
<h3 id="first-solution">First Solution</h3>
<p>A solution can be resetting variable 'ch' after each time loop runs as presented in code below,</p>
<pre><code>   if (ch == '\n') {
        cout&lt;&lt;&quot;We have encountered &quot;&lt;&lt;wordCount&lt;&lt;&quot; words in this line.&quot;&lt;&lt;endl;
        wordCount = 0;
   }
   ch = '\0';
}
</code></pre>
<p>Previously read character is erased each time the loop runs and ch cannot contain the same newline value anymore unless it really occurs on the input.</p>
<h3 id="second-solution">Second Solution</h3>
<p>We can check whether input stream is still good after character has been read like this,</p>
<pre><code>ifs.get(ch);
if (!ifs.good())
   break;
   // code
</code></pre>
<h3 id="finally">Finally</h3>
<p>We can improve it further,</p>
<pre><code>#include &lt;ifstream&gt;
#include &lt;iostream&gt;
using namespace std;
  
int main () {
    string separators(&quot;:;.!\&quot;\' \t\n&quot;);
    ifstream ifs ( &quot;test.txt&quot; , ifstream::in );
    bool shouldCountNewWord = true;
    int wordCount=0;
 
    char ch;
 
    while (ifs.get(ch).good()) {
        int i = 0;
        for (; i&lt;separators.length(); i++) {
            if (ch == separators[i]) {
                shouldCountNewWord = true;
                break;
            }
        }
 
        if (i== (int) separators.length() &amp;&amp; shouldCountNewWord == true) {
            wordCount++;
            shouldCountNewWord = false;
        }
 
 
        if (ch == '\n') {
            cout&lt;&lt;&quot;We have encountered &quot;&lt;&lt;wordCount&lt;&lt;&quot; words in this line.&quot;&lt;&lt;endl;
            wordCount = 0;
        }
    }
    ifs.close();
    return 0;
}
</code></pre>
<p>Conclusive remark is that it is easy to make mistake without remembering how istream&amp; istream<span>get ( char&amp; c ) behaves. It is always safe to use int istream</span>get() because whenever it encounters EOF it returns -1.</p>
<p>And remember that, on Linux/Unix editors like vi, gedit adds an extra new line before END OF FILE.</p>
<p>Code has been tested on Microsoft Compiler, Visual Studio and on Linux Compiler [ gcc version 4.4.6 20110731 (Red Hat 4.4.6-3) (GCC) ]</p>



						</div>
					</section>
				
				</section>
				
				<!-- Footer -->
                <footer id="footer">
                    <div class="inner">
    <section>
            <h2>Feeds</h2>
            <ul class="actions">
                <li><a href="/feed.rss" class="button small"><i class="fa fa-rss"></i> RSS Feed</a></li>
                                <li><a href="/feed.atom" class="button small"><i class="fa fa-rss"></i> Atom Feed</a></li>
            </ul>
    </section>
    <section>
    </section>
    <ul class="copyright">
        <li>Copyright © 2020</li>
        <li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
        <li><a href="https://wyam.io">Generated by Wyam</a></li>
    </ul>
</div>
                </footer>
			</div>

		<!-- Scripts -->
			<script src="/assets/js/skel.min.js"></script>
			<script src="/assets/js/jquery.min.js"></script>
			<script src="/assets/js/jquery.scrollex.min.js"></script>
			<script src="/assets/js/util.js"></script>
            <!--[if lte IE 8]><script src="/assets/js/ie/respond.min.js"></script><![endif]-->
            <script src="/assets/js/main.js"></script>

	</body>

</html>